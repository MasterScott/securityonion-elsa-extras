<!-- v. 7/19/15 --- Maintained by Josh Brower, Josh@DefensiveDepth.com-->
<ruleset name="SYSMON" id='777'>
    <pattern>ossec_archive</pattern>
    <rules>

        <!-- Create remote thread sysmon 3 and 3.10 -->
       <rule provider="DefensiveDepth-SYSMON3" class='10777' id='10777'>
                        <patterns>
                                <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@->WinEvtLog @ESTRING::(@@NUMBER::):@): @ESTRING:::@ SYSTEM: NT AUTHORITY: @ESTRING:s0::@ @ESTRING:: SequenceNumber:@ @NUMBER::@ @ESTRING:: SourceProcessGuid:@ {@ESTRING:s1:}@ @ESTRING:: SourceImage: @@ESTRING:s2:  TargetProcessGuid: {@@ESTRING:s3:}@@ESTRING:: TargetImage: @@ESTRING:s4:  NewThreadId:@</pattern>
                                <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@->WinEvtLog @ESTRING::(@@NUMBER::):@): @ESTRING:::@ SYSTEM: NT AUTHORITY: @ESTRING:s0:: @@ESTRING:: SourceProcessGuid:@ {@ESTRING:s1:}@ @ESTRING:: SourceImage: @@ESTRING:s2:  TargetProcessGuid: {@@ESTRING:s3:}@@ESTRING:: TargetImage: @@ESTRING:s4:  NewThreadId:@@ESTRING:: StartAddress:@@ESTRING:: StartModule: @@ESTRING:s5:  StartFunction:@</pattern>

                        </patterns>

                        <examples>
                                <example>
                                        <test_message program="ossec_archive">2015 Jun 02 02:18:10 (windows7_x64) 192.168.142.6->WinEvtLog 2015 Jun 01 15:53:02 WinEvtLog: Microsoft-Windows-Sysmon/Operational: INFORMATION(8): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: WIN-KTL39CHEPFC: CreateRemoteThread detected:  SequenceNumber: 599  UtcTime: 6/1/2015 09:53:02.371 PM  SourceProcessGuid: {F17228B0-CB16-556C-0000-0010A6A90000}  SourceProcessId: 468  SourceImage: C:\Windows\System32\csrss.exe  TargetProcessGuid: {F17228B0-CC30-556C-0000-0010B6510500}  TargetProcessId: 1668  TargetImage: C:\Windows\System32\cmd.exe  NewThreadId: 756</test_message>
                                                <!-- host-->
                                                <test_value name="s0">WIN-KTL39CHEPFC</test_value>
                                                <!-- sourceprocessguid-->
                                                <test_value name="s1">F17228B0-CB16-556C-0000-0010A6A90000</test_value>
                                                <!-- sourceimage-->
                                                <test_value name="s2">C:\Windows\System32\csrss.exe</test_value>
                                                <!-- targetProcessGuid-->
                                                <test_value name="s3">F17228B0-CC30-556C-0000-0010B6510500</test_value>
                                                <!-- targetimage-->
                                                <test_value name="s4">C:\Windows\System32\cmd.exe</test_value>

                                </example>
                                <example>
                                        <test_message program="ossec_archive">2015 Aug 08 16:41:28 (james_dell) 192.168.1.101->WinEvtLog 2015 Aug 08 10:41:25 WinEvtLog: Microsoft-Windows-Sysmon/Operational: INFORMATION(8): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: james-laptop: CreateRemoteThread detected:  UtcTime: 2015-08-08 16:41:25.215  SourceProcessGuid: {16F5F390-BD09-55BF-0000-001019A80300}  SourceProcessId: 2688  SourceImage: C:\Windows\System32\wbem\WmiPrvSE.exe  TargetProcessGuid: {16F5F390-3135-55C6-0000-0010C123FC1A}  TargetProcessId: 225012  TargetImage: C:\Windows\System32\wbem\WmiApSrv.exe  NewThreadId: 226380  StartAddress: 0x00007FFE7EA30710  StartModule: C:\Windows\SYSTEM32\ntdll.dll  StartFunction: </test_message>
                                                <!-- host-->
                                                <test_value name="s0">james-laptop</test_value>
                                                <!-- sourceprocessguid-->
                                                <test_value name="s1">16F5F390-BD09-55BF-0000-001019A80300</test_value>
                                                <!-- sourceimage-->
                                                <test_value name="s2">C:\Windows\System32\wbem\WmiPrvSE.exe</test_value>
                                                <!-- targetProcessGuid-->
                                                <test_value name="s3">16F5F390-3135-55C6-0000-0010C123FC1A</test_value>
                                                <!-- targetimage-->
                                                <test_value name="s4">C:\Windows\System32\wbem\WmiApSrv.exe</test_value>
                                                <!-- startmodule -->
                                                <test_value name="s5">C:\Windows\SYSTEM32\ntdll.dll</test_value>

                                </example>


                        </examples>
                </rule>


        <rule provider="DefensiveDepth" class='10778' id='10778'>
            <patterns>
                <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@->WinEvtLog @ESTRING::Microsoft-Windows-Sysmon/Operational: INFORMATION(1):@@ESTRING:::@@ESTRING:::@@ESTRING:::@ @ESTRING:s0::@@ESTRING::{@@ESTRING:s1:}@@ESTRING::Image: @@ESTRING:s2:  CommandLine: @@ESTRING::CurrentDirectory: @@ESTRING::User: @@ESTRING:s3:  LogonGuid:@@ESTRING::Hashes: @@ESTRING:s4: @@ESTRING::ParentImage: @@ESTRING:s5:  ParentCommandLine:@</pattern>
            </patterns>
            <examples>
                <example>
                                    <test_message program="ossec_archive">2015 Jul 13 13:27:17 (windows7_x64) 192.168.142.6->WinEvtLog 2015 Jul 13 07:27:16 WinEvtLog: Microsoft-Windows-Sysmon/Operational: INFORMATION(1): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: WIN-KTL39CHEPFC: Process Create:  SequenceNumber: 472  UtcTime: 7/13/2015 01:27:16.823 PM  ProcessGuid: {F17228B0-BCB4-55A3-0000-001024551800}  ProcessId: 2208  Image: C:\Windows\System32\notepad.exe  CommandLine: notepad  CurrentDirectory: C:\Users\tester\  User: WIN-KTL39CHEPFC\tester  LogonGuid: {F17228B0-B2C7-55A3-0000-0020E54F0700}  LogonId: 0x74fe5  TerminalSessionId: 1  IntegrityLevel: Medium  Hashes: SHA1=7EB0139D2175739B3CCB0D1110067820BE6ABD29  ParentProcessGuid: {F17228B0-BCB2-55A3-0000-001089501800}  ParentProcessId: 3004  ParentImage: C:\Windows\System32\cmd.exe  ParentCommandLine: "C:\Windows\system32\cmd.exe"</test_message>
                                                <!-- host-->
                                                <test_value name="s0">WIN-KTL39CHEPFC</test_value>
                                                <!-- processguid-->
                                                <test_value name="s1">F17228B0-BCB4-55A3-0000-001024551800</test_value>
                                                <!-- image-->
                                                <test_value name="s2">C:\Windows\System32\notepad.exe</test_value>
                                                <!-- user-->
                                                <test_value name="s3">WIN-KTL39CHEPFC\tester</test_value>
                                                <!-- hash-->
                                                <test_value name="s4">SHA1=7EB0139D2175739B3CCB0D1110067820BE6ABD29</test_value>
                                                <!-- parentimage-->
                                                <test_value name="s5">C:\Windows\System32\cmd.exe</test_value>
                </example>
            </examples>
        </rule>

        <rule provider="DefensiveDepth" class='10779' id='10779'>
            <patterns>
                <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@->WinEvtLog @ESTRING::(@@NUMBER::):@): @ESTRING:::@@ESTRING:::@@ESTRING:::@ @ESTRING:s0::@@ESTRING::{@@ESTRING:s1:}@@ESTRING::Image: @@ESTRING:s2: User: @@ESTRING:s3: Protocol: @@ESTRING::: @@ESTRING:s4: @@ESTRING::SourceIp: @@ESTRING:: @@ESTRING::SourcePort: @@ESTRING:i0: @@ESTRING::DestinationIp: @@ESTRING:s5: @@ESTRING::DestinationPort: @@ESTRING:i1: @</pattern>
            </patterns>
            <examples>
                <example>
                    <test_message program="ossec_archive">2014 Dec 02 20:28:31 (10.0.15.14) 10.0.15.14->WinEvtLog 2014 Dec 02 15:26:08 WinEvtLog: Microsoft-Windows-Sysmon/Operational:INFORMATION(3): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: WIN-U93G48C7BOP: Network connection detected: UtcTime: 12/1/2014 9:03 PM ProcessGuid: {00000000-D426-547C-0000-00103DB40000} ProcessId: 868 Image: C:\Windows\system32\svchost.exe User: NT AUTHORITY\NETWORK SERVICE Protocol: udp Initiated: true SourceIsIpv6: true SourceIp: a00:f0e:0:0:1822:ad8d:1e0:ffff SourceHostname: SourcePort: 60352 SourcePortName: DestinationIsIpv6: true DestinationIp: a00:f01:7200:6500:6100:2000:4300:6f00 DestinationHostname: DestinationPort: 53 DestinationPortName: domain</test_message>
                    <!-- hostname-->
                    <test_value name="s0">WIN-U93G48C7BOP</test_value>
                    <!-- processguid-->
                    <test_value name="s1">00000000-D426-547C-0000-00103DB40000</test_value>
                    <!-- image-->
                    <test_value name="s2">C:\Windows\system32\svchost.exe</test_value>
                    <!-- user-->
                    <test_value name="s3">NT AUTHORITY\NETWORK SERVICE</test_value>
                    <!-- initiated-->
                    <test_value name="s4">true</test_value>
                    <!-- sourceport-->
                    <test_value name="i0">60352</test_value>
                    <!-- destip-->
                    <test_value name="s5">a00:f01:7200:6500:6100:2000:4300:6f00</test_value>
                    <!-- destport-->
                    <test_value name="i1">53</test_value>
                </example>
            </examples>
        </rule>


       <!--https://github.com/jtaylo78/Sysmon_ELSA_Parsers -->
       <rule provider="DefensiveDepth" class='10782' id='10782'>
                        <patterns>
                                <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@->WinEvtLog @ESTRING::Microsoft-Windows-Sysmon/Operational: INFORMATION(7): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: @@ESTRING:s0:: @@ESTRING::ProcessGuid: {@@ESTRING:s1:} @@ESTRING:: Image: @@ESTRING:s2:  ImageLoaded: @@ESTRING:s3:  Hashes: @@ESTRING:s4: @@ESTRING:: Signed: @@ESTRING:s5: @</pattern>
                        </patterns>

                        <examples>
                                <example>
                                        <test_message program="ossec_archive">2016 Jul 26 03:30:18 (win8-test) 192.168.1.76->WinEvtLog 2016 Jul 26 20:14:35 WinEvtLog: Microsoft-Windows-Sysmon/Operational: INFORMATION(7): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: WIN-VL5U1V07CA7: Image loaded:  UtcTime: 2016-07-27 02:14:34.620  ProcessGuid: {B8CD0A89-D195-5796-0000-0010DDF71B00}  ProcessId: 3520  Image: C:\Windows\Sysmon.exe  ImageLoaded: C:\Windows\System32\FWPUCLNT.DLL  Hashes: SHA1=26DE7E214FE056327469E86D5D38AC744FB353FA,IMPHASH=89B1C5BA3C0EC10428AC86A1628A90EF  Signed: true  Signature: Microsoft Windows</test_message>
                                                <!-- host-->
                                                <test_value name="s0">WIN-VL5U1V07CA7</test_value>
                                                <!-- processguid-->
                                                <test_value name="s1">B8CD0A89-D195-5796-0000-0010DDF71B00</test_value>
                                                <!-- image-->
                                                <test_value name="s2">C:\Windows\Sysmon.exe</test_value>
                                                <!-- imageloaded-->
                                                <test_value name="s3">C:\Windows\System32\FWPUCLNT.DLL</test_value>
                                                <!-- hashes-->
                                                <test_value name="s4">SHA1=26DE7E214FE056327469E86D5D38AC744FB353FA,IMPHASH=89B1C5BA3C0EC10428AC86A1628A90EF</test_value>
                                                <!-- signed -->
                                                <test_value name="s5">true</test_value>

                                </example>
                        </examples>
                </rule>
                 <rule provider="DefensiveDepth" class='10783' id='10783'>
                        <patterns>
                                <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@->WinEvtLog @ESTRING::Microsoft-Windows-Sysmon/Operational: INFORMATION(2): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: @@ESTRING:s0:: @@ESTRING::ProcessGuid: {@@ESTRING:s1:} @@ESTRING:: Image: @@ESTRING:s2:  TargetFilename: @@ESTRING:s3:  CreationUtcTime: @@ESTRING:s4:  PreviousCreationUtcTime: @@ESTRING:s5:@</pattern>
                        </patterns>

                        <examples>
                                <example>
                                        <test_message program="ossec_archive">2016 Jul 26 03:31:00 (win8-test) 192.168.1.76->WinEvtLog 2016 Jul 26 20:15:16 WinEvtLog: Microsoft-Windows-Sysmon/Operational: INFORMATION(2): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: WIN-VL5U1V07CA7: File creation time changed:  UtcTime: 2016-07-27 02:15:16.727  ProcessGuid: {B8CD0A89-CDA9-5796-0000-001005E50500}  ProcessId: 3620  Image: C:\Program Files (x86)\Google\Chrome\Application\chrome.exe  TargetFilename: C:\Users\james\AppData\Roaming\Microsoft\Windows\Recent\CustomDestinations\6R7AY6B552FSY7NMWD0S.temp  CreationUtcTime: 2016-05-10 13:30:19.910  PreviousCreationUtcTime: 2016-07-27 02:15:16.727</test_message>
                                                <!-- host-->
                                                <test_value name="s0">WIN-VL5U1V07CA7</test_value>
                                                <!-- processguid-->
                                                <test_value name="s1">B8CD0A89-CDA9-5796-0000-001005E50500</test_value>
                                                <!-- image-->
                                                <test_value name="s2">C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</test_value>
                                                <!-- targetfilename -->
                                                <test_value name="s3">C:\Users\james\AppData\Roaming\Microsoft\Windows\Recent\CustomDestinations\6R7AY6B552FSY7NMWD0S.temp</test_value>

                                </example>
                        </examples>
                </rule>
                 <rule provider="DefensiveDepth" class='10784' id='10784'>
                        <patterns>
                                <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@->WinEvtLog @ESTRING::Microsoft-Windows-Sysmon/Operational: INFORMATION(5): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: @@ESTRING:s0:: @@ESTRING::ProcessGuid: {@@ESTRING:s1:} @@ESTRING:: Image: @@ESTRING:s2:@</pattern>
                        </patterns>

                        <examples>
                                <example>
                                        <test_message program="ossec_archive">2016 Jul 26 03:32:14 (win8-test) 192.168.1.76->WinEvtLog 2016 Jul 26 20:16:31 WinEvtLog: Microsoft-Windows-Sysmon/Operational: INFORMATION(5): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: WIN-VL5U1V07CA7: Process terminated:  UtcTime: 2016-07-27 02:16:31.060  ProcessGuid: {B8CD0A89-D602-5796-0000-001087702400}  ProcessId: 3424  Image: C:\Windows\System32\taskhost.exe</test_message>
                                                <!-- host-->
                                                <test_value name="s0">WIN-VL5U1V07CA7</test_value>
                                                <!-- processguid-->
                                                <test_value name="s1">B8CD0A89-D602-5796-0000-001087702400</test_value>
                                                <!-- image-->
                                                <test_value name="s2">C:\Windows\System32\taskhost.exe</test_value>

                                </example>
                        </examples>
                </rule>

                <rule provider="DefensiveDepth" class='10785' id='10785'>
                        <patterns>
                                <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@->WinEvtLog @ESTRING::Microsoft-Windows-Sysmon/Operational: INFORMATION(6): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: @@ESTRING:s0:: @@ESTRING:: ImageLoaded: @@ESTRING:s1:  Hashes: @@ESTRING:s2: @@ESTRING:: Signed: @@ESTRING:s3: @@ESTRING:: Signature: @@ANYSTRING:s4:@</pattern>
                        </patterns>

                        <examples>
                                <example>
                                        <test_message program="ossec_archive">2016 Jul 28 03:44:40 (win8-test) 192.168.1.76->WinEvtLog 2016 Jul 29 17:03:04 WinEvtLog: Microsoft-Windows-Sysmon/Operational: INFORMATION(6): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: WIN-VL5U1V07CA7: Driver loaded:  UtcTime: 2016-07-29 23:02:45.306  ImageLoaded: C:\Windows\System32\drivers\Ndu.sys  Hashes: SHA1=BA3773A62C2E67533E1C75E48DB6E62D8A92A1AA,IMPHASH=0CB044FF22A5D4FEEC3D7063EC18FF35  Signed: true  Signature: Microsoft Windows</test_message>
                                                <!-- host-->
                                                <test_value name="s0">WIN-VL5U1V07CA7</test_value>
                                                <!-- imageloaded -->
                                                <test_value name="s1">C:\Windows\System32\drivers\Ndu.sys</test_value>
                                                <!-- hash-->
                                                <test_value name="s2">SHA1=BA3773A62C2E67533E1C75E48DB6E62D8A92A1AA,IMPHASH=0CB044FF22A5D4FEEC3D7063EC18FF35</test_value>
                                                <!-- signed -->
                                                <test_value name="s3">true</test_value>
                                                <!-- Signature -->
                                                <test_value name="s4">Microsoft Windows</test_value>

                                </example>
                        </examples>
                </rule>
                 <rule provider="DefensiveDepth" class='10786' id='10786'>
                        <patterns>
                                <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@->WinEvtLog @ESTRING::Microsoft-Windows-Sysmon/Operational: INFORMATION(9): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: @@ESTRING:s0:: @@ESTRING::ProcessGuid: {@@ESTRING:s1:} @@ESTRING:: Image: @@ESTRING:s2:  Device: @@ANYSTRING:s3:@</pattern>
                        </patterns>

                        <examples>
                                <example>
                                        <test_message program="ossec_archive">2016 Jul 28 04:29:02 (win8-test) 192.168.1.76->WinEvtLog 2016 Jul 29 17:47:50 WinEvtLog: Microsoft-Windows-Sysmon/Operational: INFORMATION(9): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: WIN-VL5U1V07CA7: RawAccessRead detected:  UtcTime: 2016-07-29 23:47:50.526  ProcessGuid: {B8CD0A89-EAC9-579B-0000-001030BD0100}  ProcessId: 1436  Image: C:\Program Files\Windows Defender\MsMpEng.exe  Device: \Device\HarddiskVolume1</test_message>
                                                <!-- host-->
                                                <test_value name="s0">WIN-VL5U1V07CA7</test_value>
                                                <!-- processguid  -->
                                                <test_value name="s1">B8CD0A89-EAC9-579B-0000-001030BD0100</test_value>
                                                <!-- image-->
                                                <test_value name="s2">C:\Program Files\Windows Defender\MsMpEng.exe</test_value>
                                                <!-- device -->
                                                <test_value name="s3">\Device\HarddiskVolume1</test_value>

                                </example>
                        </examples>
                </rule>
                <rule provider="DefensiveDepth" class='10787' id='10787'>
                        <patterns>
                                <pattern>@NUMBER::@@ESTRING::(@@ESTRING::)@ @IPv4::@->WinEvtLog @ESTRING::Microsoft-Windows-Sysmon/Operational: INFORMATION(10): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: @@ESTRING:s0:: @@ESTRING:: SourceProcessGUID: {@@ESTRING:s1:} @@ESTRING:: SourceImage: @@ESTRING:s2:  TargetProcessGUID: {@@ESTRING:s3:} @@ESTRING:: TargetImage: @@ESTRING:s4:  GrantedAccess:@@ESTRING:: CallTrace: @@ANYSTRING::@</pattern>
                        </patterns>

                        <examples>
                                <example>
                                        <test_message program="ossec_archive">2016 Jul 30 15:23:09 (win8-test) 192.168.1.76->WinEvtLog 2016 Jul 30 12:18:39 WinEvtLog: Microsoft-Windows-Sysmon/Operational: INFORMATION(10): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: WIN-VL5U1V07CA7: Process accessed:  UtcTime: 2016-07-30 18:18:39.109  SourceProcessGUID: {B8CD0A89-ED98-579C-0000-001001CC0100}  SourceProcessId: 1500  SourceThreadId: 2024  SourceImage: C:\Program Files\Windows Defender\MsMpEng.exe  TargetProcessGUID: {B8CD0A89-ED97-579C-0000-00106D9B0100}  TargetProcessId: 1304  TargetImage: C:\Program Files (x86)\ossec-agent\ossec-agent.exe  GrantedAccess: 0x101000  CallTrace: C:\Windows\SYSTEM32\ntdll.dll+9091a|C:\Windows\system32\KERNELBASE.dll+2e5e|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+9e99c|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+9e8ac|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+9e841|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+56ca6d|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+38b3d8|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+1abd31|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+1a8c43|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+1a7ca8|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+1a7abe|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+1aa0cf|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+1aec46|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+1f9d5f|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+1ae4d3|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+1ae7da|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+50147|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+73413|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+2b7f00|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+410be7|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+350168|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+956c7|C:\ProgramData\Microsoft\Windows Defender\Definition Updates\{BF09301C-3DC5-498A-A66A-483CEC6AA846}\mpengine.dll+9564e|C:\Program Files\Windows Defender\mpsvc.dll+18253</test_message>
                                                <!-- host-->
                                                <test_value name="s0">WIN-VL5U1V07CA7</test_value>
                                                <!-- sourceprocessguid-->
                                                <test_value name="s1">B8CD0A89-ED98-579C-0000-001001CC0100</test_value>
                                                <!-- sourceimage-->
                                                <test_value name="s2">C:\Program Files\Windows Defender\MsMpEng.exe</test_value>
                                                <!-- targetprocessguid-->
                                                <test_value name="s3">B8CD0A89-ED97-579C-0000-00106D9B0100</test_value>
                                                <!-- targetimage-->
                                                <test_value name="s4">C:\Program Files (x86)\ossec-agent\ossec-agent.exe</test_value>

                                </example>
                        </examples>
                </rule>

    </rules>
</ruleset>


<!-- v. 2/8/15 --- Maintained by Josh Brower, Josh@DefensiveDepth.com -->
<!-- v. 9/29/2016 --- Brian Kellogg added more events and updated parsers -->
<ruleset name="WIN-PROCESS-TRACKING" id='780'>
<pattern>ossec_archive</pattern>
<rules>
    <rule provider="DefensiveDepth" class='10780' id='10780'>
        <patterns>
            <!-- 4688s with command line auditing -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::A new process has been created@@ESTRING::Target Subject:@@ESTRING::Account Name:  @@ESTRING:s1: @@ESTRING::New Process Name: @@ESTRING:s2:  @@ESTRING::Token Elevation Type: @@ESTRING:s3:  @@ESTRING::Creator Process Name: @@ESTRING:s4:  @@ESTRING::Process Command Line: @@ESTRING:s5:  @</pattern>
            <!-- 4688s -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::A new process has been created@@ESTRING::Account Name:  @@ESTRING:s1:  @@ESTRING::New Process Name: @@ESTRING:s2:  @@ESTRING::Token Elevation Type: @@ESTRING:s3:  @</pattern>
            <!-- 4689s -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::A process has exited@@ESTRING::Account Name:  @@ESTRING:s1:  @@ESTRING::Process Name: @@ESTRING:s2:  @@ESTRING::Exit Status: @</pattern>
            <!-- 4674s -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::An operation was attempted on a privileged object@@ESTRING::Account Name:  @@ESTRING:s1: @@ESTRING::Process Name: @@ESTRING:s2:  @</pattern>
            <!-- 4985s -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::The state of a transaction has changed@@ESTRING::Account Name:  @@ESTRING:s1: @@ESTRING::Process Name:  @@ANYSTRING:s2:@</pattern>
            <!-- 4673s -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::A privileged service was called@@ESTRING::Account Name:  @@ESTRING:s1: @@ESTRING::Process Name: @@ESTRING:s2:  @</pattern>
            <!-- 4648s -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::A logon was attempted using explicit credentials@@ESTRING::Account Whose Credentials Were Used@@ESTRING::Account Name:  @@ESTRING:s1:  @@ESTRING::Process Name:  @@ESTRING:s2:  @@ESTRING::Network Address: @@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::A logon was attempted using explicit credentials@@ESTRING::Account Whose Credentials Were Used@@ESTRING::Account Name:  @@ESTRING:s1:  @@ESTRING::Process Name:  @@ESTRING:s2:  @</pattern>
        </patterns>
        <examples>
            <example>
                <test_message program="ossec_archive">2015 Nov 03 19:57:01 (SERVER01) 10.1.1.1->WinEvtLog 2015 Nov 03 12:56:57 WinEvtLog: Security: AUDIT_SUCCESS(4688): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: A new process has been created. Subject:  Security ID:  S-1-5-18  Account Name:  SERVER01$  Account Domain:  CONTOSO  Logon ID:  0x3e7  Process Information:  New Process ID:  0x1994  New Process Name: C:\\Windows\\System32\\conhost.exe  Token Elevation Type: %%1936  Creator Process ID: 0x1f4</test_message>
                <!-- Event ID-->
                <test_value name="i0">4688</test_value>
                <!-- hostname-->
                <test_value name="s0">SERVER01.contoso.com</test_value>
                <!-- user-->
                <test_value name="s1">SERVER01$</test_value>
                <!-- image-->
                <test_value name="s2">C:\\Windows\\System32\\conhost.exe</test_value>
                <!-- token_elevation-->
                <test_value name="s3">%%1936</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2016 Sep 29 18:33:39 (SERVER01) 10.1.1.1->WinEvtLog 2016 Sep 29 13:00:44 WinEvtLog: Security: AUDIT_SUCCESS(4688): Microsoft-Windows-Security-Auditing: (no user): no domain: WINTEST: A new process has been created.    Creator Subject:   Security ID:  S-1-5-18   Account Name:  WINTEST$   Account Domain:  WORKGROUP   Logon ID:  0x3E7    Target Subject:   Security ID:  S-1-5-21-1799166368-2267426087-2432483420-1000   Account Name:  admin   Account Domain:  WINTEST   Logon ID:  0x3A5F9    Process Information:   New Process ID:  0x1874   New Process Name: C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_17.7167.40817.0_x64__8wekyb3d8bbwe\\HxTsr.exe   Token Elevation Type: %%1938   Mandatory Label:  S-1-16-4096   Creator Process ID: 0x290   Creator Process Name: C:\\Windows\\System32\\svchost.exe   Process Command Line: "C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_17.7167.40817.0_x64__8wekyb3d8bbwe\\HxTsr.exe" -ServerName:Hx.IPC.Server    Token Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.    Type 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.    Type 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.    Type 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator.</test_message>
                <!-- Event ID-->
                <test_value name="i0">4688</test_value>
                <!-- hostname-->
                <test_value name="s0">WINTEST</test_value>
                <!-- user-->
                <test_value name="s1">admin</test_value>
                <!-- image-->
                <test_value name="s2">C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_17.7167.40817.0_x64__8wekyb3d8bbwe\\HxTsr.exe</test_value>
                <!-- token_elevation-->
                <test_value name="s3">%%1938</test_value>
                <!-- Parent Image-->
                <test_value name="s4">C:\\Windows\\System32\\svchost.exe</test_value>
                <!-- Command-->
                <test_value name="s5">"C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_17.7167.40817.0_x64__8wekyb3d8bbwe\\HxTsr.exe" -ServerName:Hx.IPC.Server</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Nov 03 19:57:01 (SERVER01) 10.1.1.1->WinEvtLog 2015 Nov 03 13:56:57 WinEvtLog: Security: AUDIT_SUCCESS(4689): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: A process has exited. Subject:  Security ID:  S-1-5-18  Account Name:  user01  Account Domain:  CONTOSO  Logon ID:  0x3e7  Process Information:  Process ID: 0x1804  Process Name: C:\\Program Files (x86)\\PostgreSQL\\8.4\\bin\\postgres.exe  Exit Status: 0xFFFFFFFF</test_message>
                <!-- Event ID-->
                <test_value name="i0">4689</test_value>
                <!-- hostname-->
                <test_value name="s0">SERVER01.contoso.com</test_value>
                <!-- user-->
                <test_value name="s1">user01</test_value>
                <!-- image-->
                <test_value name="s2">C:\\Program Files (x86)\\PostgreSQL\\8.4\\bin\\postgres.exe</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Nov 03 19:57:02 (SERVER01) 10.1.1.1->WinEvtLog 2015 Nov 03 21:56:57 WinEvtLog: Security: AUDIT_SUCCESS(4674): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: An operation was attempted on a privileged object. Subject:  Security ID:  S-1-5-21-1202660629-2052111302-682003330-5406  Account Name:  user01  Account Domain:  CONTOSO  Logon ID:  0x20b21e  Object:  Object Server: Security  Object Type: -  Object Name: -  Object Handle: 0xce8  Process Information:  Process ID: 0x161c  Process Name: C:\\Windows\\System32\\wbem\\WmiPrvSE.exe  Requested Operation:  Desired Access: 2031619  Privileges:  SeTakeOwnershipPrivilege</test_message>
                <!-- Event ID-->
                <test_value name="i0">4674</test_value>
                <!-- hostname-->
                <test_value name="s0">SERVER01.contoso.com</test_value>
                <!-- user-->
                <test_value name="s1">user01</test_value>
                <!-- image-->
                <test_value name="s2">C:\\Windows\\System32\\wbem\\WmiPrvSE.exe</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Nov 03 19:57:04 (SERVER01) 10.1.1.1->WinEvtLog 2015 Nov 03 13:56:59 WinEvtLog: Security: AUDIT_SUCCESS(4985): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: The state of a transaction has changed. Subject:  Security ID:  S-1-5-18  Account Name:  user01  Account Domain:  CONTOSO  Logon ID:  0x3e7  Transaction Information:  RM Transaction ID: {09298C36-7B75-11E5-A2FD-005056A96845}  New State:  48  Resource Manager: {A8278C32-83AD-11E1-93DE-005056A90011}  Process Information:  Process ID:  0x388  Process Name:  C:\\Windows\\System32\\svchost.exe</test_message>
                <!-- Event ID-->
                <test_value name="i0">4985</test_value>
                <!-- hostname-->
                <test_value name="s0">SERVER01.contoso.com</test_value>
                <!-- user-->
                <test_value name="s1">user01</test_value>
                <!-- image-->
                <test_value name="s2">C:\\Windows\\System32\\svchost.exe</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Nov 03 19:57:02 (SERVER01) 10.1.1.1->WinEvtLog 2015 Nov 03 20:57:00 WinEvtLog: Security: AUDIT_FAILURE(4673): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: A privileged service was called. Subject:  Security ID:  S-1-5-21-1202660629-2052111302-682003330-62996  Account Name:  user01  Account Domain:  CONTOSO  Logon ID:  0x5ae35c17  Service:  Server: Security  Service Name: -  Process:  Process ID: 0x2bc8  Process Name: C:\\Windows\\System32\\lsass.exe  Service Request Information:  Privileges:  SeTcbPrivilege</test_message>
                <!-- Event ID-->
                <test_value name="i0">4673</test_value>
                <!-- hostname-->
                <test_value name="s0">SERVER01.contoso.com</test_value>
                <!-- user-->
                <test_value name="s1">user01</test_value>
                <!-- image-->
                <test_value name="s2">C:\\Windows\\System32\\lsass.exe</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Nov 03 19:57:01 (SERVER01) 10.1.1.1->WinEvtLog 2015 Nov 03 17:55:52 WinEvtLog: Security: AUDIT_SUCCESS(4648): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: A logon was attempted using explicit credentials. Subject:  Security ID:  S-1-5-18  Account Name:  SERVER01$  Account Domain:  CONTOSO  Logon ID:  0x3e7  Logon GUID:  {00000000-0000-0000-0000-000000000000}  Account Whose Credentials Were Used:  Account Name:  user01  Account Domain:  CONTOSO  Logon GUID:  {00000000-0000-0000-0000-000000000000}  Target Server:  Target Server Name: SERVER01  Additional Information: host/SERVER01  Process Information:  Process ID:  0x1020  Process Name:  F:\\Program Files\\Microsoft\\Exchange Server\\V14\\Bin\\MSExchangeMailSubmission.exe  Network Information:  Network Address: -  Port:   -  This event is generated when a process attempts to log on an account by explicitly specifying that accountâ€™s credentials.  This most commonly occurs in batch-type configurations such as scheduled tasks, or when using the RUNAS command.</test_message>
                <!-- Event ID-->
                <test_value name="i0">4648</test_value>
                <!-- hostname-->
                <test_value name="s0">SERVER01.contoso.com</test_value>
                <!-- user-->
                <test_value name="s1">user01</test_value>
                <!-- image-->
                <test_value name="s2">F:\\Program Files\\Microsoft\\Exchange Server\\V14\\Bin\\MSExchangeMailSubmission.exe</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Nov 03 19:57:02 (SERVER01) 10.1.1.1->WinEvtLog 2015 Nov 03 20:56:59 WinEvtLog: Security: AUDIT_SUCCESS(4648): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: A logon was attempted using explicit credentials. Subject:  Security ID:  S-1-5-18  Account Name:  SERVER01$  Account Domain:  CONTOSO  Logon ID:  0x3e7  Logon GUID:  {00000000-0000-0000-0000-000000000000}  Account Whose Credentials Were Used:  Account Name:  user01  Account Domain:  CONTOSO  Logon GUID:  {00000000-0000-0000-0000-000000000000}  Target Server:  Target Server Name: localhost  Additional Information: localhost  Process Information:  Process ID:  0x228  Process Name:  C:\\Windows\\System32\\lsass.exe  Network Information:  Network Address: 192.168.1.1  Port:   58643  This event is generated when a process attempts to log on an account by explicitly specifying that accountâ€™s credentials.  This most commonly occurs in batch-type configurations such as scheduled tasks, or when using the RUNAS command.</test_message>
                <!-- Event ID-->
                <test_value name="i0">4648</test_value>
                <!-- hostname-->
                <test_value name="s0">SERVER01.contoso.com</test_value>
                <!-- user-->
                <test_value name="s1">user01</test_value>
                <!-- image-->
                <test_value name="s2">C:\\Windows\\System32\\lsass.exe</test_value>
                <!-- Src IP-->
                <test_value name="i1">192.168.1.1</test_value>
            </example>
        </examples>
    </rule>
    </rules>
</ruleset>


<!-- v. 1/30/2017 --- Brian Kellogg -->
<ruleset name="WINDOWS" id='4'>
<pattern>ossec_archive</pattern>
<rules>
    <rule provider="ELSA" class='4' id='4'>
        <patterns>
            <!-- 4740s -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::A user account was locked out.@@ESTRING::Account Domain:  @@ESTRING:s2:  @@ESTRING::Account That Was Locked Out: @@ESTRING::Account Name:  @@ESTRING:s1: @@ESTRING::Caller Computer Name: @@ANYSTRING:s0:@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::A user account was locked out.@@ESTRING::Account Domain:  @@ESTRING:s2:  @@ESTRING::Account That Was Locked Out: @@ESTRING::Account Name:  @@ESTRING:s1:  @</pattern>

            <!-- 4776s -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:: The domain controller attempted to validate the credentials for an account.@@ESTRING::Logon Account: @@ESTRING:s1: Source Workstation: @@ESTRING:s0: Error@</pattern>

            <!-- 4624s -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @An account was successfully logged on. @ESTRING::Account Name:@@ESTRING::Account Name:  @@ESTRING:s1:  @@ESTRING::Account Domain:  @@ESTRING:s2:  @@ESTRING::Source Network Address: @@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @An account was successfully logged on. @ESTRING::Account Name:@@ESTRING::Account Name:  @@ESTRING:s1:  @@ESTRING::Account Domain:  @@ESTRING:s2:  @</pattern>

            <!-- 4625s -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @An account failed to log on. @ESTRING::Account Name:@@ESTRING::Account Name:  @@ESTRING:s1:  Account Domain:  @@ESTRING:s2:  Failure@@ESTRING::Source Network Address: @@IPv4:i1: Source Port:@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @An account failed to log on. @ESTRING::Account Name:@@ESTRING::Account Name:  @@ESTRING:s1:  Account Domain:  @@ESTRING:s2:  Failure@</pattern>

            <!-- 4768s -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @A Kerberos authentication ticket (TGT) was requested. @ESTRING::Account Name:  @@ESTRING:s1:  Supplied Realm Name: @@ESTRING:s2:  @@ESTRING::ffff:@@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @A Kerberos authentication ticket (TGT) was requested. @ESTRING::Account Name:  @@ESTRING:s1:  Supplied Realm Name: @@ESTRING:s2:  @</pattern>

            <!-- 4771s -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @Kerberos pre-authentication failed.@ESTRING::Account Name:  @@ESTRING:s1:  Service Information: @@ESTRING::ffff:@@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @Kerberos pre-authentication failed.@ESTRING::Account Name:  @@ESTRING:s1:  Service Information: @</pattern>

            <!-- 4770s -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @A Kerberos service ticket was renewed.@ESTRING::Account Name:  @@ESTRING:s1:  Account Domain:  @@ESTRING:s2:  Service Information: @@ESTRING::ffff:@@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @A Kerberos service ticket was renewed.@ESTRING::Account Name:  @@ESTRING:s1:  Account Domain:  @@ESTRING:s2:  Service Information: @@ESTRING::Client Address:  @@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @A Kerberos service ticket was renewed.@ESTRING::Account Name:  @@ESTRING:s1:  Account Domain:  @@ESTRING:s2:  Service Information: @</pattern>

            <!-- 4742s -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @A computer account was changed.@ESTRING::Account Name:  @@ESTRING:s1:  Account Domain:  @@ESTRING:s2:  Logon@</pattern>

            <!-- 4738s -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @A user account was changed.@ESTRING::Account Name:@@ESTRING::Account Name:  @@ESTRING:s1:  Account Domain:  @@ESTRING:s2:  Changed Attributes: @</pattern>

            <!-- 5145s some contained IPv4 and others contained IPv6 source IPs -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING:: @@ESTRING:s1: @@ESTRING:s2: @@ESTRING:: @File @IPv4:i1:@@ESTRING:: @@ESTRING:: @@ESTRING:s3: @@ESTRING:s4: 0x@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING:: @@ESTRING:s1: @@ESTRING:s2: @@ESTRING:: @File @ESTRING:: @@ESTRING:: @@ESTRING:s3: @@ESTRING:s4: 0x@</pattern>

            <!-- 18453s and 18454s -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::Login succeeded for user '@@ESTRING:s2:\\@@ESTRING:s1:'. @@ESTRING::CLIENT: @@IPv4:i1:]@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::Login succeeded for user '@@ESTRING:s2:\\@@ESTRING:s1:'. @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::Login succeeded for user '@@ESTRING:s1:'. @@ESTRING::CLIENT: @@IPv4:i1:]@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::Login succeeded for user '@@ESTRING:s1:'. @</pattern>

            <!-- 6278s -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @Network Policy Server @ESTRING::\\@@ESTRING:s1:  Account Domain:   @@ESTRING:s2:  Fully@@ESTRING::Client IP Address:   @@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @Network Policy Server @ESTRING::Account Name:   @@ESTRING:s1:  Account Domain:   @@ESTRING:s2:  Fully@@ESTRING::Client IP Address:   @@IPv4:i1: @</pattern>

            <!-- 5140s -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::A network share object was accessed.@@ESTRING::Account Name:  @@ESTRING:s1: @@ESTRING::Account Domain:  @@ESTRING:s2: @@ESTRING::Source Address:  File  Source Port:  @@IPv4:i1: @</pattern>

            <!-- generic patterns -->
            <!--  Sometimes pipes in Win2003 logs are in one spot and sometimes another -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::User Name: |@@ESTRING:s1:    |@@ESTRING::Domain: |@@ESTRING:s2:    |@@ESTRING::Source Network Address: @@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::User Name: |@@ESTRING:s1:    |@@ESTRING::Domain: |@@ESTRING:s2:    |@@ESTRING::Client Address: |@@IPv4:i1: |@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::User Name: |@@ESTRING:s1:    |@@ESTRING::Domain: |@@ESTRING:s2:    |@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::User Name: @@ESTRING:s1:    |@@ESTRING::Domain: |@@ESTRING:s2:    |@@ESTRING::Source Network Address: @@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::User Name: @@ESTRING:s1:    |@@ESTRING::Domain: |@@ESTRING:s2:    |@@ESTRING::Client Address: |@@IPv4:i1: |@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::User Name: @@ESTRING:s1:    |@@ESTRING::Domain: |@@ESTRING:s2:    |@</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::Primary User Name: @@ESTRING:s1:    |@@ESTRING::Primary Domain: @@ESTRING:s2:    |@</pattern>

            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::Account Name:  @@ESTRING:s1:  @@ESTRING::Account Domain:  @@ESTRING:s2:  @@ESTRING::ffff:@@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::Account Name:  @@ESTRING:s1:  @@ESTRING::Account Domain:  @@ESTRING:s2:  @</pattern>

            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::Source Network Address: @@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::ffff:@@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::Client Address: |@@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::Client Address: @@IPv4:i1: @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::User Name: @@ESTRING:s1: |@@ESTRING::Domain: |@@ESTRING:s2: |@@ESTRING::Source Network Address: - @</pattern>
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @@ESTRING::User Name: @@ESTRING:s1: |@@ESTRING::Domain: |@@ESTRING:s2: |Logon ID:@</pattern>

            <!-- pattern of last resort -->
            <pattern>@NUMBER::@@ESTRING::) @@IPv4::->WinEvtLog@@ESTRING::(@@ESTRING:i0:): @@ESTRING:::@@ESTRING:::@@ESTRING::: @@ESTRING:s0:: @</pattern>

        </patterns>
        <examples>
             <example>
                <test_message program="ossec_archive">2017 Jan 29 19:22:29 (TEST) 1.1.1.1->WinEvtLog 2017 Jan 29 13:22:26 WinEvtLog: Security: AUDIT_SUCCESS(5140): Microsoft-Windows-Security-Auditing: (no user): no domain: test.contoso.com: A network share object was accessed.  Subject:  Security ID:  S-1-5-21-126432666-12709346926-3688153413-10989949  Account Name:  USER01  Account Domain:  DOMAIN01  Logon ID:  0xdfa34d2  Network Information:   Source Address:  File  Source Port:  10.1.1.13   Share Name:   63305</test_message>
                <!-- Event ID -->
                <test_value name="i0">5140</test_value>
                <!-- Source Name -->
                <test_value name="s0">test.contoso.com</test_value>
                <!-- User -->
                <test_value name="s1">USER01</test_value>
                <!-- Domain -->
                <test_value name="s2">DOMAIN01</test_value>
                <!-- Source Network Address -->
                <test_value name="i1">10.1.1.13</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Nov 03 19:57:01 (SERVER01) 10.1.1.1->WinEvtLog 2015 Nov 03 20:56:58 WinEvtLog: Security: AUDIT_SUCCESS(4776): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: The domain controller attempted to validate the credentials for an account. Authentication Package: MICROSOFT_AUTHENTICATION_PACKAGE_V1_0 Logon Account: user01 Source Workstation: WORKSTATION01 Error Code: 0x0</test_message>
                <!-- Event ID -->
                <test_value name="i0">4776</test_value>
                <!-- Source Name -->
                <test_value name="s0">WORKSTATION01</test_value>
                <!-- User -->
                <test_value name="s1">user01</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Jul 10 06:29:11 (SERVER01) 10.1.2.3->WinEvtLog 2015 Jul 10 08:29:07 WinEvtLog: Security: AUDIT_SUCCESS(4740): Microsoft-Windows-Security-Auditing: (no user): no domain: server01.eu.d-rco.com: 0x8000000000000000    message: A user account was locked out.  Subject:  Security ID:  S-1-5-18  Account Name:  SERVER01$  Account Domain:  CONTOSO  Logon ID:  0x3e7  Account That Was Locked Out:  Security ID:  S-1-5-21-1202660629-2052111302-682003330-7883  Account Name:  bsmith  Additional Information:  Caller Computer Name: WORKSTATION01</test_message>
                <!-- Event ID -->
                <test_value name="i0">4740</test_value>
                <!-- User Domain -->
                <test_value name="s2">CONTOSO</test_value>
                <!-- User -->
                <test_value name="s1">bsmith</test_value>
                <!-- Source Name -->
                <test_value name="s0">WORKSTATION01</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Jul 09 16:31:49 (SERVER01) 10.1.2.3->WinEvtLog 2015 Jul 09 11:31:48 WinEvtLog: Security: AUDIT_SUCCESS(576): Security: bsmith: CONTOSO: SERVER01: Special privileges assigned to new logon:    |User Name: bsmith    |Domain: |CONTOSO    |Logon ID: |(0x0,0x53140A55)    |Privileges: SeSecurityPrivilege  |||SeBackupPrivilege  |||SeRestorePrivilege  |||SeTakeOwnershipPrivilege  |||SeDebugPrivilege  |||SeSystemEnvironmentPrivilege  |||SeLoadDriverPrivilege  |||SeImpersonatePrivilege                                 </test_message>
                <!-- Event ID -->
                <test_value name="i0">576</test_value>
                <!-- Source Name -->
                <test_value name="s0">SERVER01</test_value>
                <!-- User -->
                <test_value name="s1">bsmith</test_value>
                <!-- User Domain -->
                <test_value name="s2">CONTOSO</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Jul 09 16:31:38 (SERVER01) 10.1.2.3->WinEvtLog 2015 Jul 09 22:08:29 WinEvtLog: Security: AUDIT_SUCCESS(540): Security: bsmith: CONTOSO: SERVER01: Successful Network Logon:    |User Name: bsmith    |Domain: |CONTOSO    |Logon ID: |(0x0,0x2019C1A7)    |Logon Type: 3    |Logon Process: Kerberos    |Authentication Package: Kerberos    |Workstation Name:     |Logon GUID: {df727ffc-0e96-accd-6ea3-89a59e1e94d1}    |Caller User Name: -    |Caller Domain: -    |Caller Logon ID: -    |Caller Process ID: -    |Transited Services: -    |Source Network Address: 192.1.2.3    |Source Port: 64116        </test_message>
                <!-- Event ID -->
                <test_value name="i0">540</test_value>
                <!-- Source Name -->
                <test_value name="s0">SERVER01</test_value>
                <!-- User -->
                <test_value name="s1">bsmith</test_value>
                <!-- User Domain -->
                <test_value name="s2">CONTOSO</test_value>
                <!-- Source Network Address -->
                <test_value name="i1">192.1.2.3</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Jul 09 20:35:29 (SERVER01) 10.1.2.3->WinEvtLog 2015 Jul 09 22:35:28 WinEvtLog: Security: AUDIT_SUCCESS(6278): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: Network Policy Server granted full access to a user because the host met the defined health policy. User:  Security ID:   S-1-5-21-1202633329-2052111302-682003330-42024  Account Name:   CONTOSO\\bsmith  Account Domain:   CONTOSO  Fully Qualified Account Name: CONTOSO\\bsmith  Client Machine:  Security ID:   S-1-0-0  Account Name:   -  Fully Qualified Account Name: -  OS-Version:   -  Called Station Identifier:  e05f.b9ab.84b0  Calling Station Identifier:  28b2.bcce.6306  NAS:  NAS IPv4 Address:  192.1.2.3  NAS IPv6 Address:  -  NAS Identifier:   WAP1  NAS Port-Type:   Wireless - IEEE 802.11  NAS Port:   414635  RADIUS Client:  Client Friendly Name:  WAP1  Client IP Address:   192.1.2.3  Authentication Details:  Proxy Policy Name:  Use Windows authentication for all users  Network Policy Name:  Wifi Validation  Authentication Provider:  Windows  Authentication Server:  SERVER01.contoso.com  Authentication Type:  PEAP  EAP Type:   Microsoft: Secured password (EAP-MSCHAP v2)  Account Session Identifier:  -  Quarantine Information:  Result:    Full Access  Extended-Result:   -  Session Identifier:   -  Help URL:   -  System Health Validator Result(s): - </test_message>
                <!-- Event ID -->
                <test_value name="i0">6278</test_value>
                <!-- Source Name -->
                <test_value name="s0">SERVER01.contoso.com</test_value>
                <!-- User -->
                <test_value name="s1">bsmith</test_value>
                <!-- User Domain -->
                <test_value name="s2">CONTOSO</test_value>
                <!-- Source Network Address -->
                <test_value name="i1">192.1.2.3</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Jul 09 16:31:47 (SERVER01) 10.1.2.3->WinEvtLog 2015 Jul 09 12:31:43 WinEvtLog: Security: AUDIT_FAILURE(4625): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: An account failed to log on. Subject:  Security ID:  S-1-0-0  Account Name:  -  Account Domain:  -  Logon ID:  0x0  Logon Type:   3  Account For Which Logon Failed:  Security ID:  S-1-0-0  Account Name:  bsmith  Account Domain:  WRKSTATION01  Failure Information:  Failure Reason:  %%2313  Status:   0xc000006d  Sub Status:  0xc0000064  Process Information:  Caller Process ID: 0x0  Caller Process Name: -  Network Information:  Workstation Name: WRKSTATION01  Source Network Address: 192.1.2.3  Source Port:  55575  Detailed Authentication Information:  Logon Process:  NtLmSsp   Authentication Package: NTLM  Transited Services: -  Package Name (NTLM only): -  Key Length:  0  This event is generated when a logon request fails. It is generated on the computer where access was attempted.</test_message>
                <!-- Event ID -->
                <test_value name="i0">4625</test_value>
                <!-- Source Name -->
                <test_value name="s0">SERVER01.contoso.com</test_value>
                <!-- User -->
                <test_value name="s1">bsmith</test_value>
                <!-- User Domain -->
                <test_value name="s2">WRKSTATION01</test_value>
                <!-- Source Network Address -->
                <test_value name="i1">192.1.2.3</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Jul 09 16:31:34 (SERVER01) 10.1.2.3->WinEvtLog 2015 Jul 09 12:31:34 WinEvtLog: Application: AUDIT_SUCCESS(18454): MSSQL$TEST: (no user): no domain: SERVER01.contoso.com: Login succeeded for user 'bsmith'. Connection made using SQL Server authentication. [CLIENT: 192.1.2.3]</test_message>
                <!-- Event ID -->
                <test_value name="i0">18454</test_value>
                <!-- Source Name -->
                <test_value name="s0">SERVER01.contoso.com</test_value>
                <!-- User -->
                <test_value name="s1">bsmith</test_value>
                <!-- Source IP -->
                <test_value name="i1">192.1.2.3</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Jul 09 16:32:01 (DROLNW215VM) 10.1.2.3->WinEvtLog 2015 Jul 09 12:32:00 WinEvtLog: Application: AUDIT_SUCCESS(18453): MSSQL$TEST: cpcprogramadmin: CONTOSO: SERVER01.contoso.com: Login succeeded for user 'CONTOSO\\bsmith'. Connection made using Windows authentication. [CLIENT: 192.1.2.3]</test_message>
                <!-- Event ID -->
                <test_value name="i0">18453</test_value>
                <!-- Source Name -->
                <test_value name="s0">SERVER01.contoso.com</test_value>
                <!-- User Domain -->
                <test_value name="s2">CONTOSO</test_value>
                <!-- User -->
                <test_value name="s1">bsmith</test_value>
                <!-- Source IP -->
                <test_value name="i1">192.1.2.3</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Jul 09 16:31:36 (SERVER01) 10.1.2.3->WinEvtLog 2015 Jul 09 10:31:32 WinEvtLog: Security: AUDIT_SUCCESS(4656): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: A handle to an object was requested. Subject:  Security ID:  S-1-5-18  Account Name:  SERVER01$  Account Domain:  CONTOSO  Logon ID:  0x3e7  Object:  Object Server:  Security  Object Type:  File  Object Name:  \\Device\\Floppy0  Handle ID:  0x280  Process Information:  Process ID:  0  Process Name:  0xbac  Access Request Information:  Transaction ID:  {00000000-0000-0000-0000-000000000000}  Accesses:  %%1538  ||||%%1541  ||||%%4416  ||||%%4419  ||||%%4423  ||||  Access Mask:  -  Privileges Used for Access Check: 0x120089  Restricted SID Count: -</test_message>
                <!-- Event ID -->
                <test_value name="i0">4656</test_value>
                <!-- Source Name -->
                <test_value name="s0">SERVER01.contoso.com</test_value>
                <!-- User -->
                <test_value name="s1">SERVER01$</test_value>
                <!-- User Domain -->
                <test_value name="s2">CONTOSO</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Jul 06 09:11:55 (SERVER01) 10.1.2.3->WinEvtLog 2015 Jul 06 11:11:51 WinEvtLog: Security: AUDIT_SUCCESS(5145): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: S-1-5-21-1202660629-2052111302-682003330-36208 BSmith CONTOSO 0xd07fc77 File ::1 53216 \\\\*\\share1$ \\??\\E:\\shared stuff\\this\\stuff.doc 0x120089 %%1538</test_message>
                <!-- Event ID -->
                <test_value name="i0">5145</test_value>
                <!-- Source Name -->
                <test_value name="s0">SERVER01.contoso.com</test_value>
                <!-- User -->
                <test_value name="s1">BSmith</test_value>
                <!-- User Domain -->
                <test_value name="s2">CONTOSO</test_value>
                <!-- Share name -->
                <test_value name="s3">\\\\*\\share1$</test_value>
                <!-- Share path -->
                <test_value name="s4">\\??\\E:\\shared stuff\\this\\stuff.doc</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Jul 06 09:11:55 (SERVER01) 10.1.2.3->WinEvtLog 2015 Jul 06 11:11:51 WinEvtLog: Security: AUDIT_SUCCESS(5145): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: S-1-5-21-1202660629-2052111302-682003330-36208 BSmith CONTOSO 0xd07fc77 File 192.1.2.3 53216 \\\\*\\share1$ \\??\\E:\\shared stuff\\this\\stuff.doc 0x120089 %%1538</test_message>
                <!-- Event ID -->
                <test_value name="i0">5145</test_value>
                <!-- Source Name -->
                <test_value name="s0">SERVER01.contoso.com</test_value>
                <!-- User -->
                <test_value name="s1">BSmith</test_value>
                <!-- User Domain -->
                <test_value name="s2">CONTOSO</test_value>
                <!-- Source Network Address -->
                <test_value name="i1">192.1.2.3</test_value>
                <!-- Share name -->
                <test_value name="s3">\\\\*\\share1$</test_value>
                <!-- Share path -->
                <test_value name="s4">\\??\\E:\\shared stuff\\this\\stuff.doc</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Jul 09 16:31:34 (SERVER01) 10.1.2.3->WinEvtLog 2015 Jul 09 18:31:31 WinEvtLog: Security: AUDIT_SUCCESS(4770): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: A Kerberos service ticket was renewed. Account Information:  Account Name:  bsmith@contoso.com  Account Domain:  contoso.com  Service Information:  Service Name:  krbtgt  Service ID:  S-1-5-21-1233360629-2052111302-682003330-502  Network Information:  Client Address:  192.1.2.3  Client Port:  2214  Additional Information:  Ticket Options:  0x2  Ticket Encryption Type: 0x12  Ticket options and encryption types are defined in RFC 4120.</test_message>
                <!-- Event ID -->
                <test_value name="i0">4770</test_value>
                <!-- Source Name -->
                <test_value name="s0">SERVER01.contoso.com</test_value>
                <!-- User -->
                <test_value name="s1">bsmith@contoso.com</test_value>
                <!-- User Domain -->
                <test_value name="s2">contoso.com</test_value>
                <!-- Source Network Address -->
                <test_value name="i1">192.1.2.3</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Jul 09 17:31:29 (SERVER01) 10.1.2.3->WinEvtLog 2015 Jul 09 12:31:27 WinEvtLog: Security: AUDIT_SUCCESS(4738): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: A user account was changed. Subject:  Security ID:  S-1-5-7  Account Name:  ANONYMOUS LOGON  Account Domain:  NT AUTHORITY  Logon ID:  0x3e6  Target Account:  Security ID:  S-1-5-21-1433339735-357464061-2299825339-102091  Account Name:  bsmith  Account Domain:  CONTOSO  Changed Attributes:  SAM Account Name: -  Display Name:  -  User Principal Name: -  Home Directory:  -  Home Drive:  -  Script Path:  -  Profile Path:  -  User Workstations: -  Password Last Set: 7/9/2015 12:31:27 PM  Account Expires:  -  Primary Group ID: -  AllowedToDelegateTo: -  Old UAC Value:  -  New UAC Value:  -  User Account Control: -  User Parameters: -  SID History:  -  Logon Hours:  -  Additional Information:  Privileges:  -</test_message>
                <!-- Event ID -->
                <test_value name="i0">4738</test_value>
                <!-- Source Name -->
                <test_value name="s0">SERVER01.contoso.com</test_value>
                <!-- User -->
                <test_value name="s1">bsmith</test_value>
                <!-- User Domain -->
                <test_value name="s2">CONTOSO</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Jul 09 16:43:11 (SERVER01) 10.1.2.3->WinEvtLog 2015 Jul 09 12:13:08 WinEvtLog: Security: AUDIT_SUCCESS(4742): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: A computer account was changed. Subject:  Security ID:  S-1-5-21-1434109735-357333061-2299825339-41471  Account Name:  bsmith  Account Domain:  CONTOSO  Logon ID:  0x1c9d8892  Computer Account That Was Changed:  Security ID:  S-1-5-21-1434109735-357333061-2299825339-90727  Account Name:  WORKSTATION01$  Account Domain:  CONTOSO  Changed Attributes:  SAM Account Name: -  Display Name:  -  User Principal Name: -  Home Directory:  -  Home Drive:  -  Script Path:  -  Profile Path:  -  User Workstations: -  Password Last Set: 7/9/2015 12:13:07 PM  Account Expires:  -  Primary Group ID: -  AllowedToDelegateTo: -  Old UAC Value:  -  New UAC Value:  -  User Account Control: -  User Parameters: -  SID History:  -  Logon Hours:  -  DNS Host Name:  WORKSTATION01.contoso.com  Service Principal Names:   ||HOST/WORKSTATION01.contoso.com  ||RestrictedKrbHost/WORKSTATION01.contoso.com  ||HOST/WORKSTATION01  ||RestrictedKrbHost/WORKSTATION01  Additional Information:  Privileges:  -</test_message>
                <!-- Event ID -->
                <test_value name="i0">4742</test_value>
                <!-- Source Name -->
                <test_value name="s0">SERVER01.contoso.com</test_value>
                <!-- User -->
                <test_value name="s1">bsmith</test_value>
                <!-- User Domain -->
                <test_value name="s2">CONTOSO</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Jul 09 16:31:34 (SERVER01) 10.1.2.3->WinEvtLog 2015 Jul 09 18:31:32 WinEvtLog: Security: AUDIT_SUCCESS(4769): Microsoft-Windows-Security-Auditing: bsmith@contoso.com: EU.D-RCO.COM: SERVER01.contoso.com: A Kerberos service ticket was requested. Account Information:  Account Name:  bsmith@contoso.com  Account Domain:  contoso.com  Logon GUID:  {05774B76-805E-F391-B402-4C6F56704155}  Service Information:  Service Name:  CONTOSO.COM  Service ID:  S-1-5-21-1202660629-2052111302-683453330-0  Network Information:  Client Address:  ::ffff:192.1.2.3  Client Port:  2111  Additional Information:  Ticket Options:  0x40810000  Ticket Encryption Type: 0x17  Failure Code:  0x0  Transited Services: -  This event is generated every time access is requested to a resource such as a computer or a Windows service.  The service name indicates the resource to which access was requested.</test_message>
                <!-- Event ID -->
                <test_value name="i0">4769</test_value>
                <!-- Source Name -->
                <test_value name="s0">SERVER01.contoso.com</test_value>
                <!-- User -->
                <test_value name="s1">bsmith@contoso.com</test_value>
                <!-- User Domain -->
                <test_value name="s2">contoso.com</test_value>
                <!-- Source Network Address -->
                <test_value name="i1">192.1.2.3</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Jul 09 16:50:01 (SERVER01) 10.1.2.3->WinEvtLog 2015 Jul 09 11:50:00 WinEvtLog: Security: AUDIT_FAILURE(529): Security: SYSTEM: NT AUTHORITY: SERVER01: Logon Failure:    |Reason: |Unknown user name or bad password    |User Name: bsmith    |Domain: |CONTOSO    |Logon Type: 4    |Logon Process: Advapi      |Authentication Package: Negotiate    |Workstation Name: SERVER01    |Caller User Name: SERVER01$    |Caller Domain: CONTOSO    |Caller Logon ID: (0x0,0x3E7)    |Caller Process ID: 892    |Transited Services: -    |Source Network Address: 192.1.2.3    |Source Port: -    </test_message>
                <!-- Event ID-->
                <test_value name="i0">529</test_value>
                <!-- Source Name-->
                <test_value name="s0">SERVER01</test_value>
                <!-- user-->
                <test_value name="s1">bsmith</test_value>
                <!-- User Domain-->
                <test_value name="s2">CONTOSO</test_value>
                <!-- Source Network Address-->
                <test_value name="i1">192.1.2.3</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Jul 09 17:11:16 (SERVER01) 10.1.2.3->WinEvtLog 2015 Jul 09 13:11:16 WinEvtLog: Security: AUDIT_SUCCESS(528): Security: bsmith: CONTOSO: SERVER01: Successful Logon:    |User Name: bsmith    |Domain: |CONTOSO    |Logon ID: |(0x0,0x7BD160D0)    |Logon Type: 10    |Logon Process: User32      |Authentication Package: Negotiate    |Workstation Name: SERVER01    |Logon GUID: {b498dd3f-589d-8e7c-2244-121599544f51}    |Caller User Name: SERVER01$    |Caller Domain: CONTOSO    |Caller Logon ID: (0x0,0x3E7)    |Caller Process ID: 9036    |Transited Services: -    |Source Network Address: 192.1.2.3    |Source Port: 53432    </test_message>
                <!-- Event ID-->
                <test_value name="i0">528</test_value>
                <!-- Source Name-->
                <test_value name="s0">SERVER01</test_value>
                <!-- user-->
                <test_value name="s1">bsmith</test_value>
                <!-- User Domain-->
                <test_value name="s2">CONTOSO</test_value>
                <!-- Source Network Address-->
                <test_value name="i1">192.1.2.3</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Jul 09 16:31:35 (drolnwdc2) 10.1.2.3->WinEvtLog 2015 Jul 09 12:31:32 WinEvtLog: Security: AUDIT_SUCCESS(4624): Microsoft-Windows-Security-Auditing: bsmith: CONTOSO: SERVER01.contoso.com: An account was successfully logged on. Subject:  Security ID:  S-1-0-0  Account Name:  -  Account Domain:  -  Logon ID:  0x0  Logon Type:   3  New Logon:  Security ID:  S-1-5-21-1434133335-357464061-2299825339-78091  Account Name:  bsmith  Account Domain:  CONTOSO  Logon ID:  0x8c7c79e1  Logon GUID:  {33754E17-B333-0F6F-AAD6-E1BFEE3E6DBE}  Process Information:  Process ID:  0x0  Process Name:  -  Network Information:  Workstation Name:   Source Network Address: 192.1.2.3  Source Port:  61237  Detailed Authentication Information:  Logon Process:  Kerberos  Authentication Package: Kerberos  Transited Services: -  Package Name (NTLM only): -  Key Length:  0  This event is generated when a logon session is created. It is generated on the computer that was accessed.</test_message>
                <!-- Event ID -->
                <test_value name="i0">4624</test_value>
                <!-- Source Name -->
                <test_value name="s0">SERVER01.contoso.com</test_value>
                <!-- User -->
                <test_value name="s1">bsmith</test_value>
                <!-- User Domain -->
                <test_value name="s2">CONTOSO</test_value>
                <!-- Source Network Address -->
                <test_value name="i1">192.1.2.3</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Jul 09 16:31:37 (SERVER01) 10.1.2.3->WinEvtLog 2015 Jul 09 11:31:34 WinEvtLog: Security: AUDIT_SUCCESS(4768): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: A Kerberos authentication ticket (TGT) was requested. Account Information:  Account Name:  bsmith  Supplied Realm Name: CONTOSO  User ID:   S-1-5-21-1434109735-357464061-2299825339-97083  Service Information:  Service Name:  krbtgt  Service ID:  S-1-5-21-1434109735-357464061-2299837639-502  Network Information:  Client Address:  ::ffff:192.1.2.3  Client Port:  65256  Additional Information:  Ticket Options:  0x40810010  Result Code:  0x0  Ticket Encryption Type: 0x12  Pre-Authentication Type: 2  Certificate Information:  Certificate Issuer Name:    Certificate Serial Number:   Certificate Thumbprint:    Certificate information is only provided if a certificate was used for pre-authentication.  Pre-authentication types, ticket options, encryption types and result codes are defined in RFC 4120.</test_message>
                <!-- Event ID -->
                <test_value name="i0">4768</test_value>
                <!-- Source Name -->
                <test_value name="s0">SERVER01.contoso.com</test_value>
                <!-- User -->
                <test_value name="s1">bsmith</test_value>
                <!-- User Domain -->
                <test_value name="s2">CONTOSO</test_value>
                <!-- Source Network Address -->
                <test_value name="i1">192.1.2.3</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Jul 09 16:31:37 (SERVER01) 10.1.2.3->WinEvtLog 2015 Jul 09 13:33:52 WinEvtLog: Security: AUDIT_SUCCESS(673): Security: SYSTEM: NT AUTHORITY: SERVER01: Service Ticket Request:    |User Name: |bsmith@contoso.com    |User Domain: |contoso.com    |Service Name: |TEST$    |Service ID: |%{S-1-5-21-209686433-1210347603-2226485991-8004}    |Ticket Options: |0x40810000    |Ticket Encryption Type: 0x17    |Client Address: |192.1.2.3    |Failure Code: |-    |Logon GUID: |{dec9dac4-9930-8dff-2d75-27a7100037aa}    |Transited Services: -          </test_message>
                <!-- Event ID -->
                <test_value name="i0">673</test_value>
                <!-- Source Name -->
                <test_value name="s0">SERVER01</test_value>
                <!-- User -->
                <test_value name="s1">bsmith@contoso.com</test_value>
                <!-- User Domain -->
                <test_value name="s2">contoso.com</test_value>
                <!-- Source Network Address -->
                <test_value name="i1">192.1.2.3</test_value>
            </example>
            <example>
                <test_message program="ossec_archive">2015 Jul 09 16:31:34 (SERVER01) 10.1.2.3->WinEvtLog 2015 Jul 09 18:31:30 WinEvtLog: Security: AUDIT_FAILURE(4771): Microsoft-Windows-Security-Auditing: (no user): no domain: SERVER01.contoso.com: Kerberos pre-authentication failed. Account Information:  Security ID:  S-1-5-21-1063978684-905172004-2179356134-4512  Account Name:  bsmith  Service Information:  Service Name:  krbtgt/CONTOSO.COM  Network Information:  Client Address:  ::ffff:192.1.2.3  Client Port:  57911  Additional Information:  Ticket Options:  0x40810010  Failure Code:  0x12  Pre-Authentication Type: 0  Certificate Information:  Certificate Issuer Name:    Certificate Serial Number:    Certificate Thumbprint:    Certificate information is only provided if a certificate was used for pre-authentication.  Pre-authentication types, ticket options and failure codes are defined in RFC 4120.  If the ticket was malformed or damaged during transit and could not be decrypted, then many fields in this event might not be present.</test_message>
                <!-- Event ID -->
                <test_value name="i0">4771</test_value>
                <!-- Source Name -->
                <test_value name="s0">SERVER01.contoso.com</test_value>
                <!-- User -->
                <test_value name="s1">bsmith</test_value>
                <!-- Source Network Address -->
                <test_value name="i1">192.1.2.3</test_value>
            </example>
        </examples>
    </rule>
</rules>
</ruleset>
